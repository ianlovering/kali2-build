#!/usr/bin/expect -f

spawn /opt/nessus/sbin/nessuscli mkcert-client
expect -exact "Nessus username for user: "
send "pentest\r"
expect -exact "as soon as their certificate is created? (y/n) \[y\]: "
send "\r"
expect -exact "Should this user be an administrator? (y/n) \[n\]: "
send "y\r"
expect -exact "(the user can have an empty rules set)\r"
send "\r"
expect -exact "Client certificate life time in days \[365\]: "
send "\r"
expect -exact "Two letter country code \[US\]: "
send "\r"
expect -exact "State or province name \[NY\]: "
send \r"
expect -exact "City \[New York\]: "
send "\r"
expect -exact "Organization \[Nessus Users United\]: "
send "\r"
expect -exact "Organizational unit \[nessus-users\]: "
send "\r"
expect -exact "\r
Email \[none@none.com\]: "
send "\r"
expect -exact "Is this ok? (y/n) \[n\]: "
send "y\r"
expect -exact "Create another cert? (y/n) \[y\]: "
send "n\r"
